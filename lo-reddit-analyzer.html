<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LO Intel ‚Äî Reddit Pulse</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap');

  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --surface2: #1a1a26;
    --border: #2a2a40;
    --accent: #ff5c35;
    --accent2: #ffb347;
    --text: #e8e8f0;
    --muted: #6b6b8a;
    --success: #4ecdc4;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Syne', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      linear-gradient(rgba(255,92,53,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255,92,53,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 40px 24px;
    position: relative;
    z-index: 1;
  }

  /* Header */
  header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 48px;
    gap: 24px;
    flex-wrap: wrap;
  }

  .logo-area h1 {
    font-size: 2.4rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    line-height: 1;
  }

  .logo-area h1 span {
    color: var(--accent);
  }

  .logo-area p {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    color: var(--muted);
    margin-top: 8px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(255,92,53,0.12);
    border: 1px solid rgba(255,92,53,0.3);
    border-radius: 4px;
    padding: 4px 10px;
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    color: var(--accent);
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .dot {
    width: 6px;
    height: 6px;
    background: var(--accent);
    border-radius: 50%;
    animation: pulse 1.5s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.8); }
  }

  /* Controls */
  .controls {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 32px;
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 16px;
    align-items: end;
  }

  .field label {
    display: block;
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .field input, .field select {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    color: var(--text);
    font-family: 'Syne', sans-serif;
    font-size: 0.9rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .field input:focus, .field select:focus {
    border-color: var(--accent);
  }

  .field select option { background: var(--surface2); }

  .analyze-btn {
    background: var(--accent);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 12px 28px;
    font-family: 'Syne', sans-serif;
    font-size: 0.95rem;
    font-weight: 700;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
    letter-spacing: 0.02em;
  }

  .analyze-btn:hover { background: #ff3d1a; transform: translateY(-1px); }
  .analyze-btn:active { transform: translateY(0); }
  .analyze-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

  /* Status bar */
  .status-bar {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 20px;
    margin-bottom: 32px;
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    color: var(--muted);
    display: none;
    align-items: center;
    gap: 12px;
  }

  .status-bar.visible { display: flex; }
  .status-bar .spinner {
    width: 14px;
    height: 14px;
    border: 2px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    flex-shrink: 0;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Top 10 cards */
  .results-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .results-header h2 {
    font-size: 1.3rem;
    font-weight: 800;
    letter-spacing: -0.01em;
  }

  .results-header .count-badge {
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    color: var(--muted);
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 4px 12px;
    border-radius: 4px;
  }

  .complaint-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .complaint-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px 24px;
    display: grid;
    grid-template-columns: 48px 1fr auto;
    gap: 16px;
    align-items: start;
    transition: border-color 0.2s, transform 0.2s;
    animation: fadeInUp 0.4s ease both;
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .complaint-card:hover {
    border-color: rgba(255,92,53,0.4);
    transform: translateX(4px);
  }

  .rank-num {
    font-family: 'Space Mono', monospace;
    font-size: 1.8rem;
    font-weight: 700;
    line-height: 1;
    color: var(--border);
  }

  .complaint-card.top3 .rank-num { color: var(--accent); }
  .complaint-card.top3 { border-color: rgba(255,92,53,0.25); }

  .card-body h3 {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 6px;
    letter-spacing: -0.01em;
  }

  .card-body .complaint-text {
    font-size: 0.85rem;
    color: var(--muted);
    line-height: 1.6;
    margin-bottom: 10px;
  }

  .opportunity-tag {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(78,205,196,0.1);
    border: 1px solid rgba(78,205,196,0.25);
    border-radius: 4px;
    padding: 4px 10px;
    font-size: 0.72rem;
    color: var(--success);
    font-weight: 600;
    letter-spacing: 0.03em;
  }

  .heat-bar {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 4px;
    min-width: 70px;
  }

  .heat-score {
    font-family: 'Space Mono', monospace;
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--accent);
    line-height: 1;
  }

  .heat-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.6rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .heat-fill {
    width: 60px;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .heat-fill-inner {
    height: 100%;
    background: linear-gradient(90deg, var(--accent2), var(--accent));
    border-radius: 2px;
    transition: width 1s ease;
  }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: 64px 24px;
    color: var(--muted);
  }

  .empty-state .icon {
    font-size: 3rem;
    margin-bottom: 16px;
  }

  .empty-state h3 {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 8px;
    color: var(--text);
  }

  .empty-state p {
    font-size: 0.85rem;
    max-width: 380px;
    margin: 0 auto;
    line-height: 1.6;
  }

  /* Summary bar */
  .summary-strip {
    background: linear-gradient(135deg, rgba(255,92,53,0.1), rgba(255,179,71,0.08));
    border: 1px solid rgba(255,92,53,0.2);
    border-radius: 12px;
    padding: 20px 24px;
    margin-bottom: 32px;
    display: none;
  }

  .summary-strip.visible { display: block; }

  .summary-strip h3 {
    font-size: 0.8rem;
    font-family: 'Space Mono', monospace;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .summary-strip p {
    font-size: 0.9rem;
    color: var(--text);
    line-height: 1.7;
  }

  /* Paste mode toggle */
  .mode-tabs {
    display: flex;
    gap: 2px;
    background: var(--surface2);
    border-radius: 8px;
    padding: 4px;
    margin-bottom: 24px;
    width: fit-content;
  }

  .mode-tab {
    padding: 8px 20px;
    border-radius: 6px;
    font-size: 0.82rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
    background: transparent;
    color: var(--muted);
  }

  .mode-tab.active {
    background: var(--accent);
    color: #fff;
  }

  .paste-area {
    display: none;
    margin-bottom: 16px;
  }

  .paste-area.visible { display: block; }

  .paste-area textarea {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    color: var(--text);
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    line-height: 1.6;
    resize: vertical;
    min-height: 140px;
    outline: none;
    transition: border-color 0.2s;
  }

  .paste-area textarea:focus { border-color: var(--accent); }
  .paste-area textarea::placeholder { color: var(--muted); }

  @media (max-width: 640px) {
    .controls { grid-template-columns: 1fr; }
    .complaint-card { grid-template-columns: 40px 1fr; }
    .heat-bar { display: none; }
    .logo-area h1 { font-size: 1.8rem; }
  }
</style>
</head>
<body>
<div class="container">

  <header>
    <div class="logo-area">
      <h1>LO <span>Intel</span></h1>
      <p>Reddit Pulse ¬∑ Recruitment Targeting Engine</p>
    </div>
    <div class="badge"><div class="dot"></div> Live Analysis</div>
  </header>

  <!-- Mode toggle -->
  <div class="mode-tabs">
    <button class="mode-tab active" onclick="setMode('paste')">Paste Reddit Posts</button>
    <button class="mode-tab" onclick="setMode('keywords')">Keyword Focus</button>
  </div>

  <div class="controls">
    <div class="field" id="subfield">
      <label>Subreddit</label>
      <input type="text" id="subreddit" value="loanoriginators" placeholder="loanoriginators">
    </div>
    <div class="field">
      <label>Analysis Focus</label>
      <select id="focus">
        <option value="recruitment">Recruitment Opportunities</option>
        <option value="complaints">Top Complaints</option>
        <option value="company">Company Gripes</option>
        <option value="comp">Compensation Issues</option>
        <option value="tech">Technology Frustrations</option>
      </select>
    </div>
    <button class="analyze-btn" id="analyzeBtn" onclick="analyze()">‚ö° Analyze</button>
  </div>

  <div class="paste-area visible" id="pasteArea">
    <div class="field">
      <label>Paste Reddit posts/comments here (copy from r/loanoriginators)</label>
      <textarea id="pasteInput" placeholder="Paste any Reddit posts, threads, or comments from r/loanoriginators here. The more text you paste, the better the analysis. You can copy entire comment threads.&#10;&#10;Example: Just copy text from reddit.com/r/loanoriginators and paste it here..."></textarea>
    </div>
  </div>

  <div class="status-bar" id="statusBar">
    <div class="spinner"></div>
    <span id="statusText">Analyzing sentiment patterns...</span>
  </div>

  <div class="summary-strip" id="summaryStrip">
    <h3>üìç Katalyst Recruitment Insight</h3>
    <p id="summaryText"></p>
  </div>

  <div class="results-header" id="resultsHeader" style="display:none">
    <h2>Top Pain Points & Opportunities</h2>
    <div class="count-badge" id="sourceCount">‚Äî posts analyzed</div>
  </div>

  <div class="complaint-grid" id="complaintGrid">
    <div class="empty-state">
      <div class="icon">üì°</div>
      <h3>Ready to analyze</h3>
      <p>Paste Reddit posts from r/loanoriginators above, then hit Analyze. The AI will extract the top pain points and translate them into Katalyst recruitment messaging.</p>
    </div>
  </div>

</div>

<script>
let currentMode = 'paste';

function setMode(mode) {
  currentMode = mode;
  document.querySelectorAll('.mode-tab').forEach((t, i) => {
    t.classList.toggle('active', (i === 0 && mode === 'paste') || (i === 1 && mode === 'keywords'));
  });
  document.getElementById('pasteArea').classList.toggle('visible', mode === 'paste');
}

function setStatus(text, visible = true) {
  const bar = document.getElementById('statusBar');
  document.getElementById('statusText').textContent = text;
  bar.classList.toggle('visible', visible);
}

async function analyze() {
  const btn = document.getElementById('analyzeBtn');
  const focus = document.getElementById('focus').value;
  const subreddit = document.getElementById('subreddit').value || 'loanoriginators';
  const pastedText = document.getElementById('pasteInput').value.trim();

  if (currentMode === 'paste' && !pastedText) {
    alert('Please paste some Reddit text first!');
    return;
  }

  btn.disabled = true;
  setStatus('Sending to AI for analysis...');
  document.getElementById('summaryStrip').classList.remove('visible');
  document.getElementById('resultsHeader').style.display = 'none';

  const systemPrompt = `You are a mortgage industry recruitment strategist analyzing loan officer (LO) complaints and grievances from Reddit. Your job is to identify the top pain points and translate them into recruitment opportunities for The Katalyst Group, a high-performance mortgage team under ETHOS Lending.

When analyzing text, extract the genuine complaints, frustrations, and pain points that LOs are expressing. Then for each one, identify how a well-run mortgage team could position itself as the solution.

ALWAYS respond with valid JSON only. No markdown, no preamble. Format:
{
  "summary": "1-2 sentence executive summary of the biggest themes for Katalyst's recruitment strategy",
  "postsAnalyzed": <estimated number of posts/comments in the text>,
  "complaints": [
    {
      "rank": 1,
      "title": "Short pain point title",
      "complaint": "What LOs are actually saying/feeling about this (2-3 sentences, use their voice)",
      "opportunity": "How Katalyst can position this in recruitment messaging (1 sentence)",
      "heatScore": <number 1-100 representing frequency/intensity>
    }
  ]
}

Return exactly 10 complaints ranked by frequency and emotional intensity.`;

  const userPrompt = currentMode === 'paste'
    ? `Analyze these Reddit posts/comments from r/${subreddit} and extract the top 10 LO pain points. Focus: ${focus}.\n\nText to analyze:\n\n${pastedText}`
    : `Based on your knowledge of r/${subreddit} and the mortgage LO community, generate the top 10 most common pain points and complaints that loan originators express online. Focus especially on: ${focus}. Make this realistic and specific to what LOs actually post about.`;

  try {
    setStatus('AI is reading the posts...');
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        system: systemPrompt,
        messages: [{ role: 'user', content: userPrompt }]
      })
    });

    const data = await response.json();
    const raw = data.content.map(b => b.text || '').join('');
    
    // Clean JSON
    const cleaned = raw.replace(/```json|```/g, '').trim();
    const result = JSON.parse(cleaned);

    setStatus('', false);
    renderResults(result);

  } catch (err) {
    console.error(err);
    setStatus('Error ‚Äî check console. Try again.', true);
  }

  btn.disabled = false;
}

function renderResults(data) {
  // Summary
  document.getElementById('summaryText').textContent = data.summary;
  document.getElementById('summaryStrip').classList.add('visible');

  // Header
  document.getElementById('resultsHeader').style.display = 'flex';
  document.getElementById('sourceCount').textContent = `~${data.postsAnalyzed} posts analyzed`;

  // Cards
  const grid = document.getElementById('complaintGrid');
  grid.innerHTML = '';

  data.complaints.forEach((item, idx) => {
    const card = document.createElement('div');
    card.className = `complaint-card${idx < 3 ? ' top3' : ''}`;
    card.style.animationDelay = `${idx * 0.05}s`;

    const fillPct = Math.round((item.heatScore / 100) * 100);

    card.innerHTML = `
      <div class="rank-num">${String(item.rank).padStart(2,'0')}</div>
      <div class="card-body">
        <h3>${item.title}</h3>
        <p class="complaint-text">${item.complaint}</p>
        <div class="opportunity-tag">üí° ${item.opportunity}</div>
      </div>
      <div class="heat-bar">
        <div class="heat-score">${item.heatScore}</div>
        <div class="heat-label">heat</div>
        <div class="heat-fill"><div class="heat-fill-inner" style="width:${fillPct}%"></div></div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// Auto-load with knowledge-based analysis on page load so Trevor sees value immediately
window.addEventListener('load', () => {
  // Trigger a knowledge-based analysis automatically
  setTimeout(() => {
    setMode('keywords');
    document.querySelector('.mode-tab:last-child').click();
    // Quietly pre-populate
  }, 500);
});
</script>
</body>
</html>
